name: Require tests

on:
  pull_request:
    types:
      # On by default if you specify no types.
      - "opened"
      - "reopened"
      - "synchronize"
      # For `skip-label` only.
      - "labeled"
      - "unlabeled"
  workflow_dispatch:

jobs:
  require-tests:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v3
      - name: "Check for tests"
        uses: brettcannon/check-for-changed-files@v1
        with:
          prereq-pattern: |
            "/Lib/**/*.py"
            "/Modules/*"
          file-pattern: "Lib/test/**.py"
          skip-label: "skip tests"
          failure-message: "Missing tests in ${file-pattern}; please add one or apply the ${skip-label} label to the pull request"
